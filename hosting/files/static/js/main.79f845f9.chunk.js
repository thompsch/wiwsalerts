(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{114:function(e,t,n){e.exports=n(267)},267:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),c=n(20),l=n.n(c),u=n(8),o=n(6),i=n.n(o),s=n(10),m=n(37),d=n(11),f=n.n(d),p=n(19),h=n.n(p),b=n(277),E=n(269),g=n(276);var v=n(55),O=n(42);function y(e){var t=e.item,n=e.index,c=e.toggleStatus,l=Object(a.useState)(t.subscribed),o=Object(u.a)(l,2),i=(o[0],o[1]);return r.a.createElement(b.a.Item,{onClick:function(){return function(e,t){i(!t.subscribed),c(e,t)}(n,t)}},r.a.createElement(function(){return t.subscribed?r.a.createElement(O.c,{color:"green"}):r.a.createElement(O.d,{color:"gray"})},null),"  ",t.type)}function j(){var e=Object(v.a)(["\n  padding: 0;\n  margin-top: 10px;\n  width: 450px;\n"]);return j=function(){return e},e}function w(e){var t=e;return r.a.createElement(f.a,null,r.a.createElement(b.a,null,t.alerts.map(function(e,t){return r.a.createElement(y,{key:e.type,index:t,item:e,toggleStatus:n})})));function n(e,n){t.alerts[e].subscribed=!n.subscribed,(t=t).updateUser(t)}}m.a.ul(j());var x=n(278),S=n(274),k=n(270),C=n(24),U="wiwsalertservice-mpudr",P=C.e.hasAppClient(U)?C.e.getAppClient(U):C.e.initializeAppClient(U);function I(e,t){return L.apply(this,arguments)}function L(){return(L=Object(s.a)(i.a.mark(function e(t,n){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.callFunction("confirmSecret",[t,n]).then(function(e){return console.log("function response",JSON.stringify(e)),"success"===e.status||(console.error(e.message),!1)});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function T(){return(T=Object(s.a)(i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Adding phone",t),e.next=3,P.callFunction("addPhone",[t]).then(function(e){return e});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function A(){return(A=Object(s.a)(i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.callFunction("sendSMSToAll",[{msg:t}]).then(function(e){return!(!e||"success"!==e.status)});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function W(e){return F.apply(this,arguments)}function F(){return(F=Object(s.a)(i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.callFunction("updateUserAndSendText",[t]).then(function(e){return e});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function z(){return(z=Object(s.a)(i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.callFunction("softDeleteUser",[t]).then(function(e){return e});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}var N=P.getServiceClient(C.d.factory,"atlas"),_=N.db("alerts").collection("users"),B=N.db("alerts").collection("appSettings");function M(){return(M=Object(s.a)(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=X(),e.next=3,_.findOne({oauth_id:t.id}).then(function(){var e=Object(s.a)(i.a.mark(function e(n){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==n){e.next=7;break}return console.log("Creating a new user!"),e.next=4,B.findOne().then(function(){var e=Object(s.a)(i.a.mark(function e(n){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_.insertOne({oauth_id:t.id,name:t.profile.data.name,email:t.profile.data.email,phone:"(xxx)yyy-zzzz",alerts:n.alert_types,children:[{name:"",grade:""}]}).then(function(e){return e});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 4:return e.abrupt("return",e.sent);case 7:return e.abrupt("return",n);case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){console.error(e)});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function H(e){return V.apply(this,arguments)}function V(){return(V=Object(s.a)(i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W(t).then(function(e){return console.log("updated user results",e),!0}).catch(function(e){return console.error(e),!1});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function R(){return(R=Object(s.a)(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X();case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return",!1);case 5:return e.next=7,_.findOne({oauth_id:t.id}).then(function(){var e=Object(s.a)(i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t._id){e.next=2;break}return e.abrupt("return",!1);case 2:return e.next=4,B.findOne().then(function(e){return{isAdmin:e.admins.includes(t._id.toString()),user:t}}).catch(function(e){return console.error(e),!1});case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){return console.error(e),!1});case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Y(e){return G.apply(this,arguments)}function G(){return(G=Object(s.a)(i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("calling Stitch to confirm number",t,X()),e.next=3,K().then(Object(s.a)(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.findOne().then(function(e){return console.log("does phone number already exist?",e.phone_numbers.includes(t)),!e.phone_numbers.includes(t)});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)})));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function q(){return(q=Object(s.a)(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.findOne().then(function(e){return e});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function D(){return J.apply(this,arguments)}function J(){return(J=Object(s.a)(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.auth.loginWithRedirect(new C.b);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function K(){var e=new C.a;return P.auth.loginWithCredential(e)}function $(){return Q.apply(this,arguments)}function Q(){return(Q=Object(s.a)(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("logon with google"),e.next=3,P.auth.loginWithRedirect(new C.c);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function X(){return P.auth.isLoggedIn?P.auth.user:null}function Z(){var e=X();return P.auth.logoutUserWithId(e.id)}function ee(e){var t=e.close,n=Object(a.useState)(!1),c=Object(u.a)(n,2),l=c[0],o=c[1],m="",d=r.a.createRef();!l&&e.show&&o(!0);var p=Object(a.useState)(!1),b=Object(u.a)(p,2),E=b[0],v=b[1],O=Object(a.useState)(!1),y=Object(u.a)(O,2),j=y[0],w=y[1];E&&t();var C=function(){l&&o(!1),t()};return r.a.createElement(f.a,null,r.a.createElement(S.a,{show:l,onHide:C,dialogClassName:"secondary"},r.a.createElement(S.a.Header,{closeButton:!0},r.a.createElement(S.a.Title,null,"Confirm Phone Number")),r.a.createElement(S.a.Body,null,r.a.createElement(x.a,{className:"text-center",bg:"light"},j?"The code has been sent to your phone. ":"We need to confirm your phone number. Click the button below, and we'll send you a text message with a code. "),r.a.createElement(x.a,null,r.a.createElement(k.a,{disabled:j,variant:j?"secondary":"primary",onClick:function(){if(!h.a.isMobilePhone(e.phone,"en-US"))return;w(!0),t=e.phone,P.callFunction("sendConfirmationSms",[t]);var t}},j?"Code sent!":"Send me a text")),r.a.createElement("hr",null),r.a.createElement(x.a,{className:"text-center",bg:"light"},r.a.createElement("span",null,'Please enter the code in the box below, and then click "Confirm".'),r.a.createElement(g.a,{disabled:!j,ref:d,id:"sekrit",placeholder:"123456",onChange:function(e){m=e.target.value}}),r.a.createElement(k.a,{disabled:!j,variant:"primary",onClick:function(){return function(e){return U.apply(this,arguments)}(C)}},"Confirm"))),r.a.createElement(S.a.Footer,null,r.a.createElement(x.a,null,r.a.createElement(k.a,{variant:"light",onClick:C},"Cancel")))));function U(){return(U=Object(s.a)(i.a.mark(function t(n){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(""!==m){t.next=3;break}return d.current.focus(),t.abrupt("return");case 3:return t.next=5,I(e.phone,m).then(function(t){console.log(t),v(t),e.confirmPhoneChanges(t),n()});case 5:case"end":return t.stop()}},t)}))).apply(this,arguments)}}var te=n(14),ne=n(26),ae=n.n(ne),re=n(41);function ce(e){var t=e.user,n=e.updateUser,c=Object(a.useState)(t.name),l=Object(u.a)(c,2),o=l[0],i=l[1],s=Object(a.useState)(t.email),m=Object(u.a)(s,2),d=m[0],p=m[1],b=Object(a.useState)(),v=Object(u.a)(b,2),O=v[0],y=v[1];!O&&t.phone.length>0&&y(t.phone);var j=Object(a.useState)(t.confirmed),w=Object(u.a)(j,2),S=w[0],k=w[1],C=Object(a.useState)(),U=Object(u.a)(C,2),P=U[0],I=U[1];void 0===P&&I(t.phone);var L=Object(a.useState)(),T=Object(u.a)(L,2),A=T[0],W=T[1],F=O&&h.a.isMobilePhone(O,"en-US");return r.a.createElement(f.a,null,r.a.createElement(x.a,null,r.a.createElement(x.a.Header,null,"Your Contact Information"),r.a.createElement(x.a.Body,null,r.a.createElement(E.a,null,r.a.createElement(E.a.Prepend,null,"Name"),r.a.createElement(g.a,{name:"username",value:o&&" ",onChange:function(e){return z(e)}})),r.a.createElement(E.a,null,r.a.createElement(E.a.Prepend,null,"Email"),r.a.createElement(g.a,{name:"useremail",value:d&&" ",onChange:function(e){return z(e)}})),r.a.createElement(E.a,null,r.a.createElement(E.a.Prepend,null,"Phone (for texts)"),r.a.createElement(g.a,{name:"userphone",value:O,onChange:function(e){return z(e)},onBlur:function(e){return function(e){var t=Object(re.a)(e.target.value,"US");if(console.log(t),void 0===t)return;var n=t.format("E.164");if(!h.a.isMobilePhone(n,"en-US"))return;P!==e.target.value&&W(!0)}(e)}}),r.a.createElement(E.a.Append,null,!F&&r.a.createElement(te.h,{color:"red",size:"30","data-for":"novalid","data-tip":"This is not a valid phone number."}),F&&S?r.a.createElement(te.b,{color:"green",size:"30","data-for":"good","data-tip":"This is a confirmed phone number."}):r.a.createElement(te.a,{color:"gold",size:"30","data-for":"unconfirmed","data-tip":"This number has not yet been confirmed."}))),!F&&r.a.createElement("label",{style:{color:"red"}},"Please enter a valid phone number")),r.a.createElement(ee,{close:function(){return W(!1)},show:A,phone:O,id:t._id,confirmPhoneChanges:function(e){e?k(!0):(y(P),k(t.confirmed))}})),r.a.createElement(ae.a,{id:"novalid"}),r.a.createElement(ae.a,{id:"good"}),r.a.createElement(ae.a,{id:"unconfirmed"}));function z(e){switch(e.target.name){case"username":t.name=e.target.value,i(t.name);break;case"useremail":t.email=e.target.value,p(t.email);break;case"userphone":t.phone=e.target.value,y(t.phone),t.phone===P?k(!0):!0===S&&k(!1),ae.a.rebuild()}n(t)}}function le(e){var t=Object(a.useState)(!1),n=Object(u.a)(t,2),c=n[0],l=n[1],o=Object(a.useState)(!1),m=Object(u.a)(o,2),d=m[0],p=m[1],h=function(){return l(!1)},b=function(){return l(!0)};return r.a.createElement(f.a,null,r.a.createElement(k.a,{variant:"info",onClick:function(){return function(e){return E.apply(this,arguments)}()}},"Save My Changes"),r.a.createElement(S.a,{show:c,onHide:h},r.a.createElement(S.a.Header,{closeButton:!0},r.a.createElement(S.a.Title,null,d?"Saved":"Error")),r.a.createElement(S.a.Body,null,d?"Your preferences have been saved.":"Something went wrong. Please check your information and try again."),r.a.createElement(S.a.Footer,null,r.a.createElement(k.a,{variant:"secondary",onClick:h},"OK"))));function E(){return(E=Object(s.a)(i.a.mark(function t(n){var a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.saveUser();case 2:a=t.sent,p(a),b();case 5:case"end":return t.stop()}},t)}))).apply(this,arguments)}}var ue=n(271);function oe(e){var t=Object(a.useState)(c&&c._id?c:{}),n=Object(u.a)(t,2),c=n[0],l=n[1],o=Object(a.useState)(!1),m=Object(u.a)(o,2),d=m[0],p=m[1];return c&&void 0!==c._id?r.a.createElement(f.a,null,r.a.createElement(x.a,null,r.a.createElement(x.a.Header,null,r.a.createElement("h1",null,"Your Settings and Preferences")),r.a.createElement(x.a,null,!h.a.isMobilePhone(c.phone,"en-US")&&r.a.createElement(ue.a,{variant:"warning"},"It looks like you're new here! Please provide a phone number and specify what types of alerts you'd like to receive.")),r.a.createElement(ce,{updateUser:function(e){return b(e)},user:c}),r.a.createElement(x.a,null,r.a.createElement(x.a.Header,null,"Your Alert Preferences"),r.a.createElement(w,Object.assign({updateUser:function(e){return b(e)}},c))),r.a.createElement(le,{saveUser:function(){return E.apply(this,arguments)}}))):(d||(p(!0),function(){return M.apply(this,arguments)}().then(function(e){l(e),p(!1)})),r.a.createElement(f.a,null,r.a.createElement(x.a,null,r.a.createElement(x.a.Title,null,r.a.createElement("h1",null,"Loading...")))));function b(e){l(c)}function E(){return(E=Object(s.a)(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H(c);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}}var ie=n(46),se=r.a.createContext();function me(){var e=r.a.useContext(se);if(!e)throw new Error("useStitchAuth must be used within a StitchAuthProvider");return e}function de(e){var t=r.a.useState({isLoggedIn:P.auth.isLoggedIn,currentStitchUser:X()}),n=Object(u.a)(t,2),c=n[0],l=n[1];Object(a.useEffect)(function(){var e,t={onUserLoggedIn:function(e,t){t&&l(function(e){return Object(ie.a)({},e,{isLoggedIn:!0,currentUser:t})})},onUserLoggedOut:function(e,t){l(function(e){return Object(ie.a)({},e,{isLoggedIn:!1,currentUser:null})})}};return e=t,P.auth.addAuthListener(e),function(){if(P.auth.hasRedirectResult())P.auth.handleRedirectResult()}(),l(function(e){return Object(ie.a)({},e)}),function(){var e;e=t,P.auth.removeAuthListener(e)}},[]);var o=function(){var e=Object(s.a)(i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:c.isLoggedIn&&Z(),e.t0=t,e.next="anonymous"===e.t0?4:"facebook"===e.t0?5:"google"===e.t0?6:7;break;case 4:return e.abrupt("return",K());case 5:return e.abrupt("return",D());case 6:return e.abrupt("return",$());case 7:return e.abrupt("return",{});case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=Object(s.a)(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!c.isLoggedIn){e.next=4;break}return e.next=3,Z();case 3:l(Object(ie.a)({},c,{isLoggedIn:!1,currentUser:null}));case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),d=r.a.useMemo(function(){return{isLoggedIn:c.isLoggedIn,currentUser:c.currentUser,actions:{handleLogin:o,handleLogout:m}}},[c]);return r.a.createElement(se.Provider,{value:d},e.children)}var fe=n(111),pe=n.n(fe),he=n(112),be=n.n(he);function Ee(e){var t=Object(a.useState)(null),n=Object(u.a)(t,2),c=n[0],l=n[1];!c&&e.user&&l(e.user);var o=Object(a.useState)(null),i=Object(u.a)(o,2),s=i[0],m=i[1];!s&&e.field&&m(e.field);var d=Object(a.useState)(null),p=Object(u.a)(d,2),h=p[0],b=p[1];!h&&e.newValue&&b(e.newValue);var E=Object(a.useState)(null),g=Object(u.a)(E,2),v=g[0],O=g[1];!v&&e.oldValue&&O(e.oldValue);var y=Object(a.useState)(!1),j=Object(u.a)(y,2),w=j[0],x=j[1],C=e.close;!w&&e.show&&x(!0);var U=function(){w&&x(!1),C()};return r.a.createElement(f.a,null,r.a.createElement(S.a,{show:w,onHide:U},r.a.createElement(S.a.Header,{closeButton:!0},r.a.createElement(S.a.Title,null,"delete"==e.type?r.a.createElement("span",null,r.a.createElement(te.a,{size:"50",color:"red"}),r.a.createElement("span",null,"Delete User?")):r.a.createElement("span",null,r.a.createElement(te.f,{size:"50",color:"gold"}),r.a.createElement("span",null,"Update User?")))),r.a.createElement(S.a.Body,null,"delete"==e.type?r.a.createElement("span",null,r.a.createElement("b",null,"Are you sure you want to delete the following user from the system? "),r.a.createElement("br",null),c&&c.name+" ("+c.email+")"):r.a.createElement("span",null,r.a.createElement("b",null,"Are you sure you want to make the following changes?"),r.a.createElement("br",null),r.a.createElement("i",null,s),': "',v,'" ',r.a.createElement("i",null,"changed to"),'  "',h,'"'),r.a.createElement(S.a.Footer,null,r.a.createElement(k.a,{variant:"secondary",onClick:U},"Cancel"),"delete"==e.type?r.a.createElement(k.a,{variant:"danger",onClick:function(){console.log("deleting user",c),function(e){return z.apply(this,arguments)}(c).then(function(e){U()})}},"Delete User"):r.a.createElement(k.a,{variant:"primary",onClick:function(){return function(){var e={$set:{}};e.$set[s]=h,_.updateOne({_id:c._id},e,{upsert:!1}).then(function(e){console.log("user updated",e),U()}).catch(function(e){console.error("stich error",e),U()}).finally(function(){U()})}()}},"Update User")))))}function ge(){var e=function(e){return e?"asc"===e?r.a.createElement("span",{className:"pull-right"},r.a.createElement(te.d,{color:"#ababab"}),r.a.createElement(te.c,null)):"desc"===e?r.a.createElement("span",{className:"pull-right"},r.a.createElement(te.d,null),r.a.createElement(te.c,{color:"#ababab"})):null:r.a.createElement("span",{className:"pull-right"},r.a.createElement(te.d,{color:"#ababab"}),r.a.createElement(te.c,{color:"#ababab"}))},t=Object(a.useState)(null),n=Object(u.a)(t,2),c=n[0],l=n[1],o=Object(a.useState)(null),i=Object(u.a)(o,2),s=i[0],m=i[1],d=Object(a.useState)([]),p=Object(u.a)(d,2),h=p[0],b=p[1],E=[{dataField:"name",text:"Name",sort:!0,sortCaret:e},{dataField:"email",text:"Email",sort:!0,sortCaret:e},{dataField:"phone",text:"Phone",sort:!0,sortCaret:e},{dataField:"confirmed",text:"Conf?",sort:!0,sortCaret:e,align:"center",headerStyle:{fontSize:"10px"},formatter:function(e){return e?r.a.createElement(te.b,{color:"#ababab"}):r.a.createElement(te.e,{color:"#ababab"})}},{dataField:"",text:"Delete User",align:"center",events:{onClick:function(e,t,n,a,r){l(a)}},formatter:function(){return r.a.createElement(te.g,{color:"red"})}}];return 0===h.length&&_.find().toArray().then(function(e){b(e)}),r.a.createElement(f.a,null,r.a.createElement(pe.a,{bootstrap4:!0,keyField:"_id",data:h,columns:E,cellEdit:be()({mode:"dbclick",afterSaveCell:function(e,t,n,a){return m({user:n,field:a.dataField,newValue:t,oldValue:e})}}),striped:!0,hover:!0,condensed:!0,defaultSorted:[{dataField:"name",order:"desc"}]}),r.a.createElement(Ee,{close:function(){return l(null)},type:"delete",show:null!=c,user:c}),r.a.createElement(Ee,{close:function(){return m(null)},type:"update",show:null!=s,user:s}))}function ve(e){var t=Object(a.useState)(!1),n=Object(u.a)(t,2),c=n[0],l=n[1],o=e.close,i=e.message,s=e.sendText;!c&&e.show&&l(!0);var m=function(){c&&l(!1),o()};return r.a.createElement(f.a,null,r.a.createElement(S.a,{show:c,onHide:m},r.a.createElement(S.a.Header,{closeButton:!0},r.a.createElement(S.a.Title,null,"Confirm the Message Before Sending")),r.a.createElement(S.a.Body,null,i,r.a.createElement(S.a.Footer,null,r.a.createElement(k.a,{variant:"secondary",onClick:m},"Cancel"),r.a.createElement(k.a,{variant:"danger",onClick:function(){s(),m()}},"Send It!")))))}function Oe(){var e=Object(v.a)(["\n  background: #eeeeee;\n  padding: 20px;\n  height: 100%;\n  width: 100%;\n  \n  align-items: center;\n"]);return Oe=function(){return e},e}function ye(e){var t=Object(a.useState)(e&&e._id?e:{}),n=Object(u.a)(t,2),c=n[0],l=(n[1],Object(a.useState)(!1)),o=Object(u.a)(l,2),i=o[0],s=o[1],m=Object(a.useState)(!1),d=Object(u.a)(m,2),p=d[0],h=d[1],v=Object(a.useState)(!1),O=Object(u.a)(v,2),y=O[0],j=O[1],w=Object(a.useState)(!1),S=Object(u.a)(w,2),C=S[0],U=S[1],P=Object(a.useState)(),I=Object(u.a)(P,2),L=I[0],T=I[1],W=Object(a.useState)(),F=Object(u.a)(W,2),z=F[0],N=F[1],_=Object(a.useState)([]),B=Object(u.a)(_,2),M=B[0],H=B[1];(function(){return q.apply(this,arguments)})().then(function(e){if(e&&!z)N(e);else if(z&&0==M.length){var t=[];z.alert_types.map(function(e,n){return t.push({alert:e.type,checked:!1})}),H(t)}});var V=me().actions.handleLogout;return r.a.createElement(f.a,null,r.a.createElement(je,null,r.a.createElement(x.a,null,r.a.createElement(x.a.Title,null,r.a.createElement("h1",null,"Welcome ",null!=c.name?c.name:"WIWS Admininistrator!")),r.a.createElement("h3",null,"You can do the following things from this page:"),r.a.createElement(b.a,null,r.a.createElement(b.a.Item,null,r.a.createElement(k.a,{variant:"info",onClick:function(){R(),h(!0)}},"Send a Group Text")),r.a.createElement(b.a.Item,null,r.a.createElement(k.a,{variant:"info",onClick:function(){R(),j(!0)}},"Change my personal settings")),r.a.createElement(b.a.Item,null,r.a.createElement(k.a,{variant:"light",onClick:function(){R()}},"Add an Admin")),r.a.createElement(b.a.Item,null,r.a.createElement(k.a,{className:"pull-right",variant:"secondary",onClick:V},"Logout")))),p&&r.a.createElement(x.a,null,r.a.createElement(x.a.Header,null,r.a.createElement("b",null,"Send a Text Message ")),r.a.createElement(E.a,null,r.a.createElement(E.a.Prepend,null,"Message:\xa0"),r.a.createElement(g.a,{as:"textarea",name:"textBody",onChange:function(e){return T(e.target.value)}}),""!=L&&r.a.createElement(k.a,{variant:"info",onClick:function(){s(!0)}},"Send"))),y&&r.a.createElement(x.a,{id:"changesettings"},r.a.createElement(oe,null)),C&&r.a.createElement(x.a,{id:"showUsers"},r.a.createElement(ge,null))),r.a.createElement(ve,{close:function(){return s(!1)},type:"sendModal",show:i,message:L,sendText:function(){!function(e){A.apply(this,arguments)}(L),s(!1)}}));function R(){U(!1),j(!1),h(!1)}}var je=m.a.div(Oe()),we=n(272),xe=n(273);function Se(e){var t,n=me().actions,c=e.setPhone,l=e.setIsUnique,o=e.setConfirmed,m=Object(a.useState)(!0),d=Object(u.a)(m,2),p=d[0],b=d[1];return r.a.createElement(f.a,null,r.a.createElement(we.a,null,r.a.createElement("div",{className:"text-center",color:"#425060"},r.a.createElement("h2",null,"Welcome to the WIWS Alert System!"),r.a.createElement("p",null,r.a.createElement("b",null,'Please enter your phone number and press "Go!", '),r.a.createElement("br",null),r.a.createElement("b",null,"or log on with your Google or Facebook account.")),r.a.createElement(E.a,null,r.a.createElement(E.a.Prepend,null,"Phone number: "),r.a.createElement(g.a,{ref:function(e){t=e},name:"phone"}),r.a.createElement(k.a,{target:"phone",variant:"outline-primary",onClick:function(){return function(){return v.apply(this,arguments)}()}},"Go!"),!p&&r.a.createElement(E.a,null,r.a.createElement(te.h,{color:"red",size:"30","data-for":"novalid","data-tip":"This is not a valid phone number."}),r.a.createElement("p",null,"Please enter a valid phone number"))),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(xe.a,{size:"lg"},r.a.createElement(k.a,{variant:"outline-primary",onClick:function(){return n.handleLogin("google")}},r.a.createElement(O.b,{color:"#003399",size:"30px"}),"Log In with Google"),"\xa0",r.a.createElement(k.a,{variant:"outline-primary",onClick:function(){return n.handleLogin("facebook")}},r.a.createElement(O.a,{color:"#003399",size:"30px"}),"Log In with Facebook")))));function v(){return(v=Object(s.a)(i.a.mark(function e(){var a,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("my # is",t.value),a=Object(re.a)(t.value,"US"),console.log("formatted",a),void 0!==a){e.next=6;break}return b(!1),e.abrupt("return");case 6:if(r=a.format("E.164"),console.log("e.164",r),h.a.isMobilePhone(r,"en-US")){e.next=13;break}return b(!1),e.abrupt("return");case 13:return console.log("my formatted # is",r),e.next=16,n.handleLogin("anonymous").then(Object(s.a)(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y(r).then(function(e){console.log("unique",e),c(r),l(e),e||o(!0),b(!0)});case 2:case"end":return e.stop()}},e)})));case 16:case"end":return e.stop()}},e)}))).apply(this,arguments)}}var ke=n(275),Ce=n(279),Ue=n(113);function Pe(){var e=Object(a.useState)(),t=Object(u.a)(e,2),n=t[0],c=t[1],l=Object(a.useState)(),o=Object(u.a)(l,2),i=o[0],s=o[1],m=Object(a.useState)(),d=Object(u.a)(m,2),p=d[0],b=d[1],v=Object(a.useState)(),O=Object(u.a)(v,2),y=O[0],j=O[1],w=Object(a.useState)(!1),S=Object(u.a)(w,2),C=S[0],U=S[1],P=Object(a.useState)(!0),I=Object(u.a)(P,2),L=I[0],A=I[1],W=p&&h.a.isMobilePhone(p,"en-US"),F=Object(a.useState)(),z=Object(u.a)(F,2),N=z[0],_=z[1];p&&void 0===N&&_(p),console.log("phone & orig?",p,N),n&&p&&(n.phone=p),void 0===i&&function(){return R.apply(this,arguments)}().then(function(e){s(e.isAdmin),c(e.user)});var B=me(),M=B.isLoggedIn;B.actions.handleLogout;return r.a.createElement(we.a,null,r.a.createElement(ke.a,{bg:"info",variant:"light"},r.a.createElement(Ce.a,null,r.a.createElement(ke.a.Brand,{href:"wiws.org"},r.a.createElement("img",{alt:"WIWS Logo",src:"/logo.jpg",className:"d-inline-block align-top"}))),r.a.createElement(Ce.a,{className:"ml-auto"},r.a.createElement(ke.a.Text,null,r.a.createElement("h1",null,"WIWS Text Alert System"))),r.a.createElement(Ce.a,{className:"ml-auto"},r.a.createElement(Ue.a,null,M&&r.a.createElement(k.a,{className:"pull-right",variant:"secondary",onClick:H},"Logout")))),r.a.createElement(function(){return console.log("phone, unique, confirmed",p,L,C),p!==N&&(A(!0),U(!1)),p?r.a.createElement(f.a,null,r.a.createElement(x.a,null,L&&!C&&r.a.createElement(ue.a,{variant:"warning"},'Welcome! We need to verify your phone number before we can send you text messages. Please check the phone number and click the "Verify" button.'),r.a.createElement(E.a,null,r.a.createElement(g.a,{name:"userphone",value:p,onChange:function(e){!function(e){b(e.target.value),console.log("phonechanged",p,N)}(e)}}),r.a.createElement(E.a.Append,null,!W&&r.a.createElement(te.h,{color:"red",size:"30","data-for":"novalid","data-tip":"This is not a valid phone number."}),W&&C?r.a.createElement(te.b,{color:"green",size:"30","data-for":"good","data-tip":"This is a confirmed phone number."}):r.a.createElement(te.a,{color:"gold",size:"30","data-for":"unconfirmed","data-tip":"This number has not yet been confirmed."}))),r.a.createElement(k.a,{onClick:function(){return function(){console.log("CheckNumber",p);var e=Object(re.a)(p,"US");console.log(e),void 0!==e&&h.a.isMobilePhone(e.number,"en-US")&&(Y(p)?(A(!0),j(!0),ae.a.rebuild()):A(!1))}()},disabled:C},"Verify"),!W&&r.a.createElement("label",{style:{color:"red"}},"Please enter a valid phone number")),r.a.createElement(ee,{close:function(){return j(!1)},show:y,phone:p,confirmPhoneChanges:function(e){return t=e,console.log("succ",t),void(t?(console.log("success confirming phone",p),U(!0),function(e){T.apply(this,arguments)}(p.toString())):U(n.confirmed));var t}}),r.a.createElement(ae.a,{id:"novalid"}),r.a.createElement(ae.a,{id:"good"}),r.a.createElement(ae.a,{id:"unconfirmed"}),L&&C&&r.a.createElement(f.a,null,r.a.createElement(ue.a,{variant:"success"},"Thank you. Your number has been confirmed and you will start receiving text messages from WIWS."),r.a.createElement(k.a,{variant:"secondary",onClick:H},"Logout")),!L&&r.a.createElement(f.a,null,r.a.createElement(ue.a,{variant:"success"},"This phone number is already confirmed in the system and should be receiving texts from WIWS."),r.a.createElement(k.a,{variant:"secondary",onClick:H},"OK"))):M&&i?r.a.createElement(ye,n):r.a.createElement(Se,{setPhone:function(e){return b(e)},setIsUnique:function(e){return A(e)},setConfirmed:function(e){U(e)},user:n})},null));function H(){b(null),s(!1),A(!0),U(!1)}}n(266);var Ie=document.getElementById("root");l.a.render(r.a.createElement(function(){return r.a.createElement(de,null,r.a.createElement(Pe,null))},null),Ie)}},[[114,1,2]]]);
//# sourceMappingURL=main.79f845f9.chunk.js.map